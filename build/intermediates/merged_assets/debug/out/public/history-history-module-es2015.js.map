{"version":3,"sources":["./src/app/history/history.page.html","./src/app/history/history-routing.module.ts","./src/app/history/history.module.ts","./src/app/history/history.page.scss","./src/app/history/history.page.ts","./src/app/shared/services/orders.service.ts"],"names":[],"mappings":"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","file":"history-history-module-es2015.js","sourcesContent":["export default \"\\r\\n<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-item>\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n      <ion-title>История заказов</ion-title>\\r\\n    </ion-item>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content>\\r\\n  <div *ngIf=\\\"orders.length!==0; else empty\\\">\\r\\n    <ion-item *ngFor=\\\"let order of orders\\\">\\r\\n      {{order.date|date:'short'}}\\r\\n    </ion-item>\\r\\n  </div>\\r\\n  <!-- <div class=\\\"page-title\\\">\\r\\n    <button (click)=\\\"isFilterVisible=!isFilterVisible\\\" class=\\\"btn btn-small\\\" [ngClass]=\\\"{'active': isFilterVisible, \\r\\n  'red':isFiltered()}\\\"\\r\\n      data-tooltip=\\\"Открыть фильтр\\\" data-position=\\\"left\\\" #tooltip>\\r\\n      <i class=\\\"material-icons\\\">filter_list</i>\\r\\n    </button>\\r\\n  </div>\\r\\n  \\r\\n  \\r\\n  <app-history-filter (onFilter)=\\\"applyFilter($event)\\\" *ngIf=\\\"isFilterVisible\\\"></app-history-filter>\\r\\n-->\\r\\n  <!-- <div *ngIf=\\\"!reloading; else reloadingBlock\\\">\\r\\n    <div *ngIf=\\\"orders.length!==0; else empty\\\">\\r\\n      <table class=\\\"highlight mb2\\\">\\r\\n        <thead>\\r\\n        <tr>\\r\\n            <th>№</th>\\r\\n            <th>Дата</th>\\r\\n            <th>Время</th>\\r\\n            <th>Сумма</th>\\r\\n            <th></th>\\r\\n        </tr>\\r\\n        </thead>\\r\\n    \\r\\n        <tbody>\\r\\n        \\r\\n        <tr *ngFor=\\\"let order of orders\\\">\\r\\n            <td>{{order.order}}</td>\\r\\n            <td>{{order.date | date: 'dd.MM.yyyy'}}</td>\\r\\n            <td>{{order.date | date:'HH:mm'}}</td>\\r\\n            <td>{{computePrice(order)}} руб.</td>\\r\\n            <td>\\r\\n                <button (click)='selectOrder(order)' class=\\\"btn btn-small grey darken-1\\\"><i class=\\\"material-icons\\\">open_in_new</i></button>\\r\\n            </td>\\r\\n        </tr>\\r\\n        </tbody>\\r\\n    </table>\\r\\n    \\r\\n    \\r\\n    \\r\\n    \\r\\n    \\r\\n    <div id=\\\"order-list\\\" class=\\\"modal modal-fixed-footer\\\" #modal>\\r\\n        <div class=\\\"modal-content\\\" *ngIf=\\\"selectedOrder\\\">\\r\\n            <h4 class=\\\"mb1\\\">Заказ №{{selectedOrder.order}}</h4>\\r\\n            <table class=\\\"highlight\\\">\\r\\n                <thead>\\r\\n                <tr>\\r\\n                    <th>Название</th>\\r\\n                    <th>Количество</th>\\r\\n                    <th>Цена</th>\\r\\n                </tr>\\r\\n                </thead>\\r\\n    \\r\\n                <tbody>\\r\\n                <tr  *ngFor=\\\"let item of selectedOrder.list\\\">\\r\\n                    <td>{{item.name}}</td>\\r\\n                    <td>{{item.quantity}}</td>\\r\\n                    <td>{{item.cost}}</td>\\r\\n                </tr>\\r\\n                </tbody>\\r\\n            </table>\\r\\n            <div class=\\\"order-summary\\\">\\r\\n                <p>Общая стоимость <strong>{{computePrice(selectedOrder)}} руб.</strong></p>\\r\\n            </div>\\r\\n        </div>\\r\\n        <div class=\\\"modal-footer\\\">\\r\\n            <button (click)=\\\"closeModal()\\\" class=\\\"modal-action waves-effect waves-black btn-flat\\\">Закрыть</button>\\r\\n        </div>\\r\\n    </div>\\r\\n\\r\\n    \\r\\n    <div class=\\\"center mb2\\\" *ngIf=\\\"!noMoreOrders\\\">\\r\\n      <button class=\\\"btn waves-effect grey darken-1 btn-small\\\" (click)=\\\"loadMore()\\\"\\r\\n        *ngIf=\\\"!loading; else loader\\\">Загрузить еще</button> -->\\r\\n      <ng-template #loader>\\r\\n        <!-- loader -->\\r\\n      </ng-template>\\r\\n  \\r\\n    <!-- </div>\\r\\n  </div> \\r\\n   -->\\r\\n  <ng-template #empty>\\r\\n    <div class=\\\"center\\\">У вас пока нет заказов</div>\\r\\n  </ng-template>\\r\\n  \\r\\n  <!-- </div> -->\\r\\n  \\r\\n  <ng-template #reloadingBlock>\\r\\n    <!-- loader -->\\r\\n  </ng-template>\\r\\n  \\r\\n</ion-content>\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { HistoryPage } from './history.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HistoryPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class HistoryPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { HistoryPageRoutingModule } from './history-routing.module';\r\n\r\nimport { HistoryPage } from './history.page';\r\nimport { HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { TokenInterceptor } from '../shared/classes/token.interceptor';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    HistoryPageRoutingModule\r\n  ],\r\n  providers: [\r\n    {\r\n      provide: HTTP_INTERCEPTORS,\r\n      multi: true,\r\n      useClass: TokenInterceptor\r\n    }\r\n  ],\r\n  declarations: [HistoryPage,]\r\n})\r\nexport class HistoryPageModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2hpc3RvcnkvaGlzdG9yeS5wYWdlLnNjc3MifQ== */\";","import { Component, OnInit } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { OrdersService } from '../shared/services/orders.service';\r\n\r\n@Component({\r\n  selector: 'app-history',\r\n  templateUrl: './history.page.html',\r\n  styleUrls: ['./history.page.scss'],\r\n})\r\nexport class HistoryPage implements OnInit {\r\n\r\n  // @ViewChild('tooltip', { static: false }) tooltipRef: ElementRef\r\n\r\n  STEP = 15\r\n\r\n  // tooltip: MaterialInstance\r\n  isFilterVisible = false\r\n\r\n  offset = 0\r\n  limit = 2\r\n\r\n  oSub: Subscription\r\n  orders = []\r\n\r\n  loading = false\r\n  reloading = false\r\n\r\n  noMoreOrders = false\r\n\r\n  // filter: Filter = {}\r\n\r\n\r\n\r\n  constructor(private ordersService: OrdersService) { }\r\n\r\n\r\n  ngOnInit() {\r\n    this.reloading = true\r\n    this.fetch()\r\n  }\r\n\r\n  private fetch() {\r\n\r\n    // const params = Object.assign({}, this.filter, {\r\n    //   offset: this.offset,\r\n    //   limit: this.STEP\r\n    // })\r\n\r\n    this.oSub = this.ordersService.fetch().subscribe(\r\n      orders => {\r\n        this.orders = this.orders.concat(orders)\r\n        this.noMoreOrders = orders.length < this.STEP\r\n        this.loading = false\r\n        this.reloading = false\r\n      }\r\n    )\r\n  }\r\n\r\n  loadMore() {\r\n    this.offset += this.STEP;\r\n    this.loading = true\r\n    this.fetch()\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    // this.tooltip.destroy()\r\n    this.oSub.unsubscribe()\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    // this.tooltip = MaterialService.initTooltip(this.tooltipRef)\r\n  }\r\n\r\n  applyFilter(filter) {\r\n    this.orders = []\r\n    this.offset = 0\r\n    // this.filter = filter\r\n    this.reloading = true\r\n    this.fetch()\r\n\r\n  }\r\n\r\n  isFiltered() {\r\n    // return Object.keys(this.filter).length !== 0\r\n  }\r\n}\r\n","import { Observable } from 'rxjs';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\n// import { Order } from '../interfaces';\r\n\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class OrdersService {\r\n\r\n    basea = 'https://salty-cove-68792.herokuapp.com'\r\n\r\n    constructor(private http: HttpClient) { }\r\n\r\n    create(order: any): Observable<any> {\r\n        return this.http.post<any>(this.basea + '/api/order', order)\r\n    }\r\n\r\n    fetch(params: any = {}): Observable<any[]> {\r\n        return this.http.get<any[]>(this.basea + '/api/order', {\r\n            params:new HttpParams({\r\n                fromObject:params\r\n            })\r\n        })\r\n    }\r\n}"],"sourceRoot":"webpack:///"}